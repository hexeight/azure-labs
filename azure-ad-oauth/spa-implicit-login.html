<!DOCTYPE html>
<head>
    <script>
        /*
        https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
        client_id=6731de76-14a6-49ae-97bc-6eba6914391e
        &response_type=id_token
        &redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
        &scope=openid
        &response_mode=fragment
        &state=12345
        &nonce=678910
        */

        const appConfig = {
            tenantId: "981c08e3-3aac-4b99-9ead-f05044d30a50",
            clientId: "79254b4e-c4fc-4998-b1b2-b01d11249365",
            responseType: "code",
            responseMode: "fragment",
            redirectUri: "http://localhost:8080/spa-implicit-token.html",
            scope: "https://graph.microsoft.com/.default"
        };

        // Generate GUID - Ctrl + C, Ctrl + V from http://blog.shkedy.com/2007/01/createing-guids-with-client-side.html
        function generateGuid() {
            var result, i, j;
            result = '';
            for (j = 0; j < 32; j++) {
                if (j == 8 || j == 12 || j == 16 || j == 20)
                    result = result + '-';
                i = Math.floor(Math.random() * 16).toString(16).toUpperCase();
                result = result + i;
            }
            return result;
        }

        function login(t) {
            let state = generateGuid();
            let nonce = generateGuid();
            sessionStorage.setItem("oauth_state", state);
            sessionStorage.setItem("openid_nonce", nonce);
            window.location = "https://login.microsoftonline.com/" + appConfig.tenantId + "/oauth2/v2.0/authorize?" +
                "client_id=" + appConfig.clientId +
                "&response_type=" + appConfig.responseType +
                "&redirect_uri=" + appConfig.redirectUri +
                "&scope=" + appConfig.scope +
                "&response_mode=" + appConfig.responseMode +
                "&state=" + state +
                "&nonce=" + nonce;
        }
    </script>
</head>

<body>
    <div>
        This is bare minimum demo for OAuth 2.0 Implicit flow with Azure AD. If you would like to read more, visit <a
            href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow">https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow</a>
    </div>
    <div>
        <button onclick="login('test')">Login</button>
    </div>
</body>

</html>